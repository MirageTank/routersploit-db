# Multi SSH Authorized Keys

## Description
Module exploits private key exposure vulnerability. If the target is vulnerable it is possible to authentiate to the device.

## Authors
* xistence <xistence[at]0x90.nl>
* Cristiano Maruti (@cmaruti)
* Jasper Greve
* HD Moore
* Matta Consulting
* egypt
* Marcin Bury <marcin.bury[at]reverse-shell.com>

## References
* [https://github.com/rapid7/ssh-badkeys](https://github.com/rapid7/ssh-badkeys)
* [http://packetstormsecurity.com/files/125761/Array-Networks-vxAG-xAPV-Privilege-Escalation.html](http://packetstormsecurity.com/files/125761/Array-Networks-vxAG-xAPV-Privilege-Escalation.html)
* [http://seclists.org/fulldisclosure/2015/Jan/76](http://seclists.org/fulldisclosure/2015/Jan/76)
* [https://github.com/cmaruti/reports/raw/master/barracuda_load_balancer_vm.pdf](https://github.com/cmaruti/reports/raw/master/barracuda_load_balancer_vm.pdf)
* [https://gist.github.com/todb-r7/5d86ecc8118f9eeecc15](https://gist.github.com/todb-r7/5d86ecc8118f9eeecc15)
* [https://www.trustmatta.com/advisories/MATTA-2012-002.txt](https://www.trustmatta.com/advisories/MATTA-2012-002.txt)
* [https://community.rapid7.com/community/metasploit/blog/2012/06/11/scanning-for-vulnerable-f5-bigips-with-metasploit](https://community.rapid7.com/community/metasploit/blog/2012/06/11/scanning-for-vulnerable-f5-bigips-with-metasploit)
* [http://packetstormsecurity.com/files/125754/Loadbalancer.org-Enterprise-VA-7.5.2-Static-SSH-Key.html](http://packetstormsecurity.com/files/125754/Loadbalancer.org-Enterprise-VA-7.5.2-Static-SSH-Key.html)
* [https://www.kb.cert.org/vuls/id/662676](https://www.kb.cert.org/vuls/id/662676)
* [http://packetstormsecurity.com/files/125755/quantum-root.txt](http://packetstormsecurity.com/files/125755/quantum-root.txt)
* [https://github.com/mitchellh/vagrant/tree/master/keys](https://github.com/mitchellh/vagrant/tree/master/keys)
* [https://community.rapid7.com/community/infosec/blog/2016/04/07/r7-2016-04-exagrid-backdoor-ssh-keys-and-hardcoded-credentials](https://community.rapid7.com/community/infosec/blog/2016/04/07/r7-2016-04-exagrid-backdoor-ssh-keys-and-hardcoded-credentials)

## Vulnerable devices
* ExaGrid firmware < 4.8 P26
* Quantum DXi V1000
* Array Networks vxAG 9.2.0.34 and vAPV 8.3.2.17 appliances
* Barracuda Load Balancer
* Ceragon FibeAir IP-10
* F5 BigIP
* Loadbalancer.org Enterprise VA 7.5.2
* Digital Alert Systems DASDEC and Monroe Electronics One-Net E189 Emergency Alert System
* Vagrant
